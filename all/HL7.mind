{"root":{"data":{"id":"cnrac9jvjow0","created":1666323381320,"text":"UWS HL7","expandState":"expand"},"children":[{"data":{"id":"cnwazp73oo00","created":1666833017535,"text":"初始化","expandState":"expand","layout":null},"children":[{"data":{"id":"cnracmd2au80","created":1666323409206,"text":"DwTool::SetAutoRun()设置开机自启","layout":null},"children":[]},{"data":{"id":"cnrad1xtuw80","created":1666323443114,"text":"g_config.SetPath()设置配置文件路径","layout":null},"children":[]},{"data":{"id":"cnradmlcbzc0","created":1666323488071,"text":"BOOL CHL7_serverApp::IsValidLicense()检查序列号","expandState":"expand","layout":null},"children":[{"data":{"id":"cnrajvp8t4w0","created":1666323978083,"text":"serial.txt","layout":null},"children":[]},{"data":{"id":"cnrammuo1540","created":1666324193912,"text":"CTools::check_serial()","layout":null},"children":[]},{"data":{"id":"cnrar5zqf1k0","created":1666324549034,"text":"dlg.DoModal()","layout":null},"children":[{"data":{"id":"cnrar8asv940","created":1666324554057,"text":"void CDlg_hlp_regist::OnOK()","layout":null},"children":[]}]}]},{"data":{"id":"cnrd160pxzs0","created":1666330974955,"text":"初始化数据库g_db.Open()","layout":null},"children":[]},{"data":{"id":"cnrd3vvi7yo0","created":1666331187965,"text":"用应用程序名创建信号量","layout":null},"children":[{"data":{"id":"cnrd5t3fabk0","created":1666331338642,"text":"程序是否运行","layout":null},"children":[]}]},{"data":{"id":"cnrdbzwgbo00","created":1666331823643,"text":"数据库升级，增加字段","layout":null},"children":[]}]},{"data":{"id":"cnracg8r1gw0","created":1666323395885,"text":"BOOL CHL7_serverApp::InitInstance()","layout":null},"children":[{"data":{"id":"cnrd71rcetc0","created":1666331435866,"text":"CHL7_serverDlg::CHL7_serverDlg()","layout":null},"children":[{"data":{"id":"cnrdfqnal8o0","created":1666332116954,"text":"CHL7_server::CHL7_server()","layout":null},"children":[]}]},{"data":{"id":"cnrdispj3io0","created":1666332356536,"text":"CHL7_server::load_cfg()加载config中配置项","layout":null},"children":[{"data":{"id":"cnrdk4shgz40","created":1666332461200,"text":"CHL7_event::encode_mode","layout":null},"children":[]}]},{"data":{"id":"cnrdkmh52800","created":1666332499696,"text":"CHL7_server_http::load_cfg()","layout":null},"children":[]},{"data":{"id":"cnrdmsv7u600","created":1666332670336,"text":"CHL7_serverDlg::OnInitDialog()","layout":null},"children":[{"data":{"id":"cnrdrmu8bq00","created":1666333049037,"text":"CHL7_serverDlg::set_server()设置HIS服务器","layout":null},"children":[{"data":{"id":"cnrdtcsrjs00","created":1666333183908,"text":"m_server.set_server(strIP, port, listen_port)","layout":null},"children":[]}]}]},{"data":{"id":"cnrdu8bawbk0","created":1666333252510,"text":"m_server.m_trans_mode通信方式TCP\\IP","layout":null},"children":[]},{"data":{"id":"cnrhmnk2bp40","created":1666343943217,"text":"HL7_app.txt部分中文字段对应","layout":null},"children":[]}]},{"data":{"id":"cnrdx5vc6wg0","created":1666333482283,"text":"void CHL7_serverDlg::OnBtnStartup()启动服务器","layout":null},"children":[{"data":{"id":"cnrdxyfjd4w0","created":1666333544455,"text":"m_server.start();","layout":null},"children":[{"data":{"id":"cnrdyqan2vs0","created":1666333605108,"text":"bool CHL7_server::start()","layout":null},"children":[{"data":{"id":"cnrdyrgy0og0","created":1666333607666,"text":"bool CHL7_server::ini_dir() 传输方式、创建XXsend等文件夹","layout":null},"children":[]},{"data":{"id":"cnrdzu4xz6o0","created":1666333691835,"text":"void CHL7_seg_factory::load(CString strVersion)获取HL7_segment.xml中节点：可使用的消息类型","layout":null},"children":[{"data":{"id":"cnre1e11n680","created":1666333813499,"text":"void CHL7_seg_factory::release()释放m_arrSegment数组","layout":null},"children":[]},{"data":{"id":"cnre44ufrao0","created":1666334028601,"text":"CXMLParser::Create() xml解析器，解析HL7_segment.xml","layout":null},"children":[]},{"data":{"id":"cnre47gdgc80","created":1666334034281,"text":"BOOL CXMLParser::Load(CString strFileName)","layout":null},"children":[{"data":{"id":"cnre69j5q000","created":1666334195531,"text":"BOOL CXMLParser::LoadXml(CString strXML)","layout":null},"children":[]}]},{"data":{"id":"cnreahsz2740","created":1666334526996,"text":"获取HL7_SEGMENT节点","expandState":"expand","layout":null},"children":[{"data":{"id":"cnream26dts0","created":1666334536259,"text":"void CHL7_segment::load_node()","layout":null},"children":[]},{"data":{"id":"cnree2wgbwo0","created":1666334808011,"text":"将所有节点放入CHL7_segment.m_arrItems中，即存储所有可用消息类型","layout":null},"children":[]},{"data":{"id":"cnreidvcjbs0","created":1666335145346,"text":"所有field放入tagHL7_seg_item.arrSub中","layout":null},"children":[]}]}]},{"data":{"id":"cnreor2s2iw0","created":1666335644278,"text":"监听端口","expandState":"expand","layout":null},"children":[{"data":{"id":"cnrejm6stnk0","created":1666335241816,"text":"bool CQue_socket::create_listener()创建socket监听","layout":null},"children":[]},{"data":{"id":"cnrelith57k0","created":1666335391209,"text":"创建线程HANDLE m_hThread;\nHANDLE m_hSend_thread;\nHANDLE m_hProc_thread;","layout":null},"children":[{"data":{"id":"cnren86xai80","created":1666335524806,"text":"void CHL7_server::do_recv()","layout":null},"children":[]},{"data":{"id":"cnren9j9s280","created":1666335527729,"text":"void CHL7_server::do_send()","layout":null},"children":[]},{"data":{"id":"cnrenjxsqso0","created":1666335550375,"text":"void CHL7_server::do_proc()","layout":null},"children":[]}]},{"data":{"id":"cnreok8ykco0","created":1666335629414,"text":"void CHL7_serverDlg::add_msg()开始监听","layout":null},"children":[]}]}]}]}]},{"data":{"id":"cnresub6jq00","created":1666335964773,"text":"CHL7_serverDlg::send2HIS()从数据库表t_HL7_que获取最大id、数据（每_timer_hl7 5000ms获取一次）","layout":null},"children":[]},{"data":{"id":"cnrfj7yx1i80","created":1666338031975,"text":"文件接收","layout":null},"children":[{"data":{"id":"cnrfjacbf3s0","created":1666338037139,"text":"void CHL7_server::do_recv()","layout":null},"children":[]},{"data":{"id":"cnrfjgjt4aw0","created":1666338050652,"text":"void CHL7_server::do_proc()","layout":null,"expandState":"expand"},"children":[{"data":{"id":"cnrfw1nblkg0","created":1666339036947,"text":"CHL7_server::process_recv_file(const char *pszFile)接收文件解析","layout_right_offset":{"x":13,"y":-2},"layout":null},"children":[{"data":{"id":"cnrfw6hz8sw0","created":1666339047508,"text":"BOOL CHL7_event::parse(CString &strMsg)","layout":null},"children":[{"data":{"id":"cnrgi4f9rnk0","created":1666340767002,"text":"BOOL CHL7_segment::parse(CString strFull_msg)段中field解析","layout":null},"children":[{"data":{"id":"cnrgklhqszk0","created":1666340960885,"text":"BOOL CHL7_segment::load_seg(const char* strSeg_name)获取HL7_segment.xml文件中对应消息类型的所有子节点","layout":null},"children":[]}]}]},{"data":{"id":"cnwb3kt3bog0","created":1666833321438,"text":"处理ACK消息"},"children":[]},{"data":{"id":"cnwb4f60g940","created":1666833387522,"text":"bool CHL7_server::process_event()"},"children":[{"data":{"id":"cnwb56zkhbs0","created":1666833448083,"text":"获取病人信息、检查信息"},"children":[]}]}]}]},{"data":{"id":"cnrfk6bntyg0","created":1666338106756,"text":"void CHL7_server::do_send()","layout":null},"children":[]},{"data":{"id":"cnrfmqjlc3c0","created":1666338307499,"text":"int CHL7_server::get_file() 获取recv、send文件夹中所有文件","layout":null},"children":[]}]},{"data":{"id":"cnrhoicx5eg0","created":1666344088630,"text":"BOOL CUWS_db::save_his_check()更新数据库","layout":null},"children":[]}]},"template":"right","theme":"fresh-blue","version":"1.4.43"}